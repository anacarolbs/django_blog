<!-- blog/templates/blog/index.html -->

{% block page_title %}
    <h2>Blog Posts</h2>
{% endblock page_title %}

{% block page_content %}
    {% block posts %}
        {% for post in posts %}
            <div class="post">
                <h3><a href="{% url 'blog_detail' post.pk %}">{{ post.title }}</a></h3>
                <small>
                    {{ post.created_on.date }} | Categorias:
                    {% for category in post.categories.all %}
                        <a href="{% url 'blog_category' category.name %}">
                            {{ category.name }}
                        </a>
                    {% endfor %}
                </small>
                <p>{{ post.body | slice:":400" }}...</p>

                <!-- Exibir reações ao post -->
                <p><strong>Reações:</strong> 
                    {% for reaction in post.reactions.all %}
                        {{ reaction.reaction_type }}
                    {% endfor %}
                </p>

                <!-- Exibir média de avaliações -->
                <p><strong>Avaliação:</strong> Média de 
                    {% if post.ratings.count > 0 %}
                        {{ post.ratings.aggregate_avg }} estrelas
                    {% else %}
                        Ainda sem avaliações.
                    {% endif %}
                </p>
                
                <!-- Link para sugestões de post -->
                <p><a href="{% url 'blog_suggestions' %}">Ver sugestões de post</a></p>
            </div>
        {% endfor %}
    {% endblock posts %}
{% endblock page_content %}
